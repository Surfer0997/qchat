import Head from 'next/head';
import ChatHeader from '@/components/ChatWindow/ChatHeader';
import Menu from '@/components/LeftMenu/Menu';
import ChatWindow from '@/components/ChatWindow/ChatWindow';
import { useSelector } from 'react-redux';
import { RootState } from '@/store/store';
import {useEffect, useState} from 'react';
import { useRouter } from 'next/router';
import icon from '../../public/favicon.ico'
import bg from '../../public/dark-doodle.webp'

export default function Home() {
  const userId = useSelector((state: RootState) => state.user.data._id);
  const router = useRouter();

  useEffect(()=>{
    if (!userId) router.push('/login')
  }, [userId, router])


 // MOBILE SWITCH SCREENS
 const isMenuOpen = useSelector((state:RootState)=>state.layout.isMenuOpen);

  if (!userId) {
    return null;
  }


  return (
    <>
      <Head>
        <title>QChat</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href={icon.src} />
      </Head>
      <main className="flex" style={{ backgroundImage: `url(${bg.src})`, backgroundPosition:'center', backgroundSize:'cover'}}>
        <Menu />

        <div className={`w-8/12 flex flex-col h-screen relative max-sm:${isMenuOpen ? 'hidden' : 'w-full'}`} style={{animation:`${window.innerWidth <= 600 ? 'slide .5s forwards' : ''}`}}>
          <ChatHeader />
          <ChatWindow />
        </div>
      </main>
    </>
  );
}
